{% extends "layout.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Car Listings</h2>
    {% if loggedIn %}
    <a href="add.php" class="btn btn-success">
        <i class="fa-solid fa-plus"></i> Add Car
    </a>
    {% endif %}
</div>

<form method="GET" class="mb-4">
    <input type="text" name="brand" value="{{ search_brand }}" placeholder="Search by Brand">
    <input type="text" name="model" value="{{ search_model }}" placeholder="Search by Model">
    <input type="number" name="year" value="{{ search_year }}" placeholder="Search by Year">
    <input type="number" name="max_price" value="{{ search_max_price }}" placeholder="Max Price">
    <button class="btn btn-primary">Search</button>
</form>

<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Brand</th>
            <th>Model</th>
            <th>Year</th>
            <th>Price</th>
            <th>Mileage</th>
            <th>Fuel Type</th>
            {% if loggedIn %}
            <th>Actions</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
    {% for car in cars %}
        <tr>
            <td>{{ car.brand }}</td>
            <td>{{ car.model }}</td>
            <td>{{ car.year }}</td>
            <td>Â£{{ car.price }}</td>
            <td>{{ car.mileage }} miles</td>
            <td>{{ car.fuel_type }}</td>
            {% if loggedIn %}
            <td>
                <a href="edit.php?id={{ car.id }}" class="btn btn-warning btn-sm">Edit</a>
                <form action="delete.php" method="POST" style="display:inline;">
                    <input type="hidden" name="id" value="{{ car.id }}">
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure?')">Delete</button>
                </form>
            </td>
            {% endif %}
        </tr>
    {% endfor %}
    </tbody>
</table>

{% if cars is empty %}
<p>No cars found matching your search criteria.</p>
{% endif %}

{% endblock %}
